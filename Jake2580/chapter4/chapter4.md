# 병행 프로세스

<br>

프로세서 하나는 한 번에 프로세스 하나만 실행할 수 있지만<br>운영체제가 프로세서를 빠르게 전환하여 프로세서 시간을 나눠서<br>마치 프로세스 여러 개를 동시에 실행하는 것처럼 보이게 하는 것을 병행 프로세스라고 한다.

<br>

- 독립 프로세스
	- 단일 처리 시스템에서 서로 독립적으로 작업을 수행
	- 프로세서에서 독립적으로 실행할 수 있는 프로세스 예시
		- 단일 프로그래밍
			- 프로세스를 사용 중이던 프로세스를 완료한 후 다른 프로세스 실행
		- 다중 프로그래밍
			- 프로세스 여러 개가 프로세서 하나를 공유
			- 공유하지 않은 상태일 때 디스패치 순서는 무관
		- 다중 처리
			- 프로세서 2개 이상 사용
			- 동시에 프로그램 여러 개를 병렬로 실행
			- 동일한 시스템에서 서로 다른 시간에<br>서로 다른 프로세서에서 실행할 수 있음

<br>

- 협력 프로세스
	- 다른 프로세스와 협력하면서 특정 기능을 수행
	- 상호작용하며 특정 기능을 수행하는 비동기적 프로세스
	- 제한된 컴퓨터 자원의 효율성 증대
	- 계산 속도 향상
	- 모듈적 구성 강화
	- 여러 작업을 동시에 수행할 수 있는 편의성을 제공하는데 사용

<br>

- 병렬성(실제로 동시에 처리가 되는 것)
	- 다중 프로세서 시스템에서 동일한 시간에 별도의 프로세서에서 실행하는 것

<br>

- 병행성(동시에 실행되는 것처럼 보이는 것)
	- 시분할로 각 프로세스의 실행 단계를 전환하여<br>어느 한순간에는 프로세스 하나를 실행하도록 하는 방법으로<br>단일 프로세서 시스템에서도 가능함

<br><br><br><br><br>

# 상호배제(Mutual exclusion)

<br>

상호배제는 병행 프로세스에서 프로세스 하나가 공유 자원을 사용할 때<br>다른 프로세스들이 동일한 일을 할 수 없도록 하는 방법이다.

<br>

- 상호배제
	- 두 프로세스는 동시에 공유 자원을 진입할 수 없음
	- 프로세스의 속도나 프로세서 수에 영향을 받지 않음
	- 공유 자원을 사용하는 프로세스만 다른 프로세스를 차단할 수 있음
	- 프로세스가 공유 자원을 사용하려고 너무 오래 기다려서는 안 됨

<br><br><br><br><br>

## 임계 영역(Critical Section)

<br>

임계 영역에는 다수의 프로세스가 접근할 수 있지만<br>어느 한 순간에는 프로세스 하나만 사용 할 수 있다.<br>

<br>

그러므로 어떤 프로세스가 임계 영역에 들어가면<br>다른 프로세스는 임계 영역으로 진입할 수 없어야 한다.

<br>

![Critical Section](/Jake2580/chapter4/image/p4-14.jpg)

<br><br><br><br><br>

## 뮤텍스(mutex)

<br>

뮤텍스는 키(key)에 해당하는 어떤 오브젝트가 있으며<br>이 오브젝트를 소유한 쓰레드나 프로세스만이 공유자원에 접근할 수 있다.

<br>

![Mutex](/Jake2580/chapter4/image/Mutex.png)

<br>

- 과정
	- 1번 프로세스가 자원을 접근하기 위해 Key를 점유
	- 1번 프로세스는 키를 점유했기 때문에 공유 자원을 사용
	- 2번 프로세스가 공유 자원을 사용하기를 원함
	- 2번 프로세스는 키를 점유하기 위해 대기
	- 3번 프로세스 또한 공유 자원을 사용하기 위해 2번 프로세스 다음 순번으로 대기
	- 1번 프로세스가 공유 자원을 다 사용하고 Key를 반환
	- 2번 프로세스는 대기하고 있다가 반환된 Key를 점유하고 공유 자원을 사용

<br><br><br><br><br>

## 세마포어(semaphore)

<br>

세마포어는 임계구역을 진입하기 어려울 때<br>자발적으로 대기상태에 들어가는 것이다.

<br>

임계구역을 떠나는 프로세스가<br>대기상태에 있는 프로세스를 준비 상태로 깨워준다.

<br>

![Semaphore](/Jake2580/chapter4/image/Semaphore.png)

<br>

- 과정
	- 공유 자원에 대한 최대 허용치를 정의
		- 최대 허용치 3으로 정의
	- 1번 프로세스가 공유 자원에 접근
		- 허용치는 2로 감소
	- 2번 프로세스가 공유 자원에 접근
		- 허용치 1로 감소
	- 3번 프로세스가 공유 자원에 접근
		- 허용치 0으로 감소
	- 4번 프로세스가 공유 자원에 접근
		- 허용치 0이므로 대기
	- 2번 프로세스가 공유 자원을 다 사용하여 혀용치 1로 증가
		- 허용치 1로 증가
	- 4번 프로세스는 대기 하다 허용치가 1로 증가되어 공유 자원에 접근
		- 허용치 0으로 감소

<br><br><br><br><br>

## 뮤텍스와 세마포어의 차이점

<br>

- 세마포어는 뮤텍스가 될 수 있지만<br>뮤텍스는 세마포어가 될 수 없음
- 세마포어는 소유할 수 없지만<br>뮤텍스는 소유할 수 있고 소유주가 그에 대한 책임을 가짐
- 세마포어는 동기화 대싱이 여러개 일 때 사용하고<br>뮤텍스는 동기화 대상이 오직 하나 일 때 사용함

<br><br><br><br><br>

## 모니터(monitor)

<br>

동기화 문제를 해결하기 위해서 세마포어라는 방법을 사용했지만<br>아래와 같은 문제점을 갖고 있다.

<br>

- 코딩하기 어려움
- 정확성(correctness)의 입증이 힘듦
- 자발적 협력(voluntary cooperation)이 필요
- 한 번의 실수가 모든 시스템에 치명적 영향을 줌

<br>

모니터 내에서는 한 번에 하나의 프로세스만 활동이 가능하고<br>프로그래머가 동기화 제약 조건을 명시적으로 코딩할 필요가 없다는 장점이 있다.

<br>

또한 프로세스가 모니터 안에서 기다릴 수 있도록<br>조건 변수(Condition Variable)을 사용한다.

<br>

이는 wait/signal 연산에 의해서만 접근이 가능하다.

<br>

- wait()
	- 다른 프로세스가 signal을 하기 전까지 대기(suspend) 됨
- signal()
	- 정확하게 하나의 대기(suspend) 된 프로세스를 깨움

<br>

![Monitor](/Jake2580/chapter4/image/Monitor.jpg)

<br><br><br><br><br>
